<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EtymoLogos | 深度词源字典</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        paper: {
                            50: '#fdfbf7',
                            100: '#fbf6ef',
                            200: '#f5ebdc',
                            300: '#ebdcc3',
                            400: '#dcc2a1',
                            500: '#cba57e',
                            600: '#be8f65',
                            700: '#9e734f',
                            800: '#805d44',
                            900: '#684d3a',
                        },
                        ink: '#2d2a26'
                    },
                    fontFamily: {
                        serif: ['"Noto Serif SC"', '"Songti SC"', 'serif'],
                        sans: ['"Inter"', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out forwards',
                        'slide-up': 'slideUp 0.6s ease-out forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel Standalone (Modern) -->
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts for atmosphere -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #f2ece4; /* Fallback */
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23dcc2a1' fill-opacity='0.15'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Custom Loader */
        .quill-loader {
            width: 48px;
            height: 48px;
            border: 3px solid #cba57e;
            border-radius: 50%;
            display: inline-block;
            position: relative;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        .quill-loader::after {
            content: '';  
            box-sizing: border-box;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid transparent;
            border-bottom-color: #805d44;
            animation: rotation 0.5s linear infinite reverse;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // --- Icons (SVG Components) ---
        // Fixed corrupted SVG path in Search icon
        const Icons = {
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" /></svg>,
            Volume: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-6 h-6"><path strokeLinecap="round" strokeLinejoin="round" d="M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z" /></svg>,
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>,
            Puzzle: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M14.25 6.087c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.036-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959v0a.64.64 0 01-.657.643 48.39 48.39 0 01-4.163-.3c.186 1.613.293 3.25.315 4.907a.656.656 0 01-.658.663v0c-.355 0-.676-.186-.959-.401a1.647 1.647 0 00-1.003-.349c-1.036 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401v0c.31 0 .555.26.532.57a48.039 48.039 0 01-.642 5.056c1.518.19 3.058.309 4.616.354a.64.64 0 00.657-.643v0c0-.355-.186-.676-.401-.959a1.647 1.647 0 00-.349-1.003c0-1.035 1.008-1.875 2.25-1.875 1.243 0 2.25.84 2.25 1.875 0 .369-.128.713-.349 1.003-.215.283-.4.604-.4.959v0c0 .333.277.599.61.58a48.1 48.1 0 005.427-.63 48.05 48.05 0 00.582-4.717.532.532 0 00-.533-.57v0c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.035 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.37 0 .713.128 1.003.349.283.215.604.401.959.401v0c.31 0 .555-.26.532-.57a48.039 48.039 0 01-.642-5.056c-1.518-.19-3.057-.309-4.616-.354a.64.64 0 00-.657.643v0z" /></svg>,
            Quill: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>,
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>,
            Trash: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-4 h-4"><path strokeLinecap="round" strokeLinejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg>,
            Key: () => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-5 h-5"><path strokeLinecap="round" strokeLinejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" /></svg>
        };

        // --- Helper Components ---
        const Card = ({ children, className = "", title, icon: Icon, delay = "0s" }) => (
            <div 
                className={`bg-white rounded-xl shadow-sm border border-paper-200 p-6 mb-6 opacity-0 animate-slide-up ${className}`}
                style={{ animationDelay: delay }}
            >
                {title && (
                    <h3 className="font-serif text-xl text-paper-900 mb-4 flex items-center gap-2 border-b border-paper-100 pb-2">
                        {Icon && <Icon />}
                        {title}
                    </h3>
                )}
                {children}
            </div>
        );

        const Badge = ({ children, color = "amber" }) => {
            const colors = {
                amber: "bg-amber-50 text-amber-800 border-amber-200",
                stone: "bg-stone-100 text-stone-700 border-stone-200",
                rose: "bg-rose-50 text-rose-800 border-rose-200",
            };
            return (
                <span className={`px-3 py-1 rounded-full text-sm border ${colors[color] || colors.amber} inline-block mr-2 mb-2`}>
                    {children}
                </span>
            );
        };

        // --- Main App ---
        function App() {
            const [apiKey, setApiKey] = useState(() => {
                try {
                    return localStorage.getItem("gemini_api_key") || "";
                } catch {
                    return "";
                }
            });
            const [query, setQuery] = useState("");
            const [loading, setLoading] = useState(false);
            const [data, setData] = useState(null);
            const [error, setError] = useState(null);
            const [vocabList, setVocabList] = useState(() => {
                try {
                    return JSON.parse(localStorage.getItem("vocab_list")) || [];
                } catch {
                    return [];
                }
            });
            const [showKeyModal, setShowKeyModal] = useState(!apiKey);

            useEffect(() => {
                try {
                    localStorage.setItem("vocab_list", JSON.stringify(vocabList));
                } catch (e) {
                    console.warn("LocalStorage unavailable");
                }
            }, [vocabList]);

            const saveApiKey = (key) => {
                setApiKey(key);
                try {
                    localStorage.setItem("gemini_api_key", key);
                } catch (e) {
                    console.warn("LocalStorage unavailable");
                }
                setShowKeyModal(false);
            };

            const handleSpeak = (text) => {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'en-US';
                    utterance.rate = 0.9; // Slightly slower for clarity
                    window.speechSynthesis.speak(utterance);
                }
            };

            const handleAddVocab = () => {
                if (data && !vocabList.some(v => v.word === data.word)) {
                    const newItem = { word: data.word, def: data.definition_en };
                    setVocabList([newItem, ...vocabList]);
                }
            };

            const removeVocab = (wordToRemove) => {
                setVocabList(vocabList.filter(item => item.word !== wordToRemove));
            };

            const performSearch = async () => {
                if (!query.trim() || !apiKey) return;
                
                setLoading(true);
                setError(null);
                setData(null);

                // Prompt Engineering
                const prompt = `
                Analyze the English word "${query}". 
                Return STRICT JSON (no markdown, no backticks) with this schema:
                {
                    "word": "The word (capitalized correctly)",
                    "ipa": "IPA pronunciation",
                    "part_of_speech": "noun/verb/etc",
                    "definition_en": "Short English definition",
                    "definition_zh": "Chinese translation",
                    "etymology_story": "A engaging, warm, narrative style story in Chinese about the word's origin (etymology). Make it interesting, like a storyteller in a library.",
                    "morphology": {
                        "root": "Root/Stem",
                        "root_meaning": "Meaning of root",
                        "related_words": ["word1", "word2"]
                    },
                    "synonyms": ["syn1", "syn2"],
                    "antonyms": ["ant1", "ant2"],
                    "literature_examples": [
                        {"en": "Example sentence 1", "zh": "Chinese translation", "source": "Title, Author"}
                    ] (Provide exactly 5 examples from classic literature like Shakespeare, Austen, Dickens, etc.)
                }
                `;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }]
                        })
                    });

                    const json = await response.json();

                    if (json.error) {
                        throw new Error(json.error.message);
                    }

                    // Parse result. Handle potential markdown code blocks if the model misbehaves.
                    // Add safe access to candidate parts
                    const candidate = json.candidates?.[0];
                    if (!candidate) {
                         throw new Error("No response from the muse (Model returned no candidates).");
                    }
                    
                    let text = candidate.content?.parts?.[0]?.text;
                    if (!text) {
                        throw new Error("The pages are blank (No text in response).");
                    }

                    text = text.replace(/```json/g, '').replace(/```/g, '').trim();
                    const resultData = JSON.parse(text);
                    
                    setData(resultData);

                } catch (err) {
                    setError(err.message || "Failed to fetch data. Please check your API Key.");
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen font-sans text-paper-900 pb-20">
                    
                    {/* Header */}
                    <header className="bg-paper-100 border-b border-paper-200 sticky top-0 z-10 backdrop-blur-md bg-opacity-90">
                        <div className="max-w-4xl mx-auto px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-2">
                                <span className="text-2xl font-serif font-bold text-paper-800 tracking-tight">Etymo<span className="text-paper-600">Logos</span></span>
                            </div>
                            <button 
                                onClick={() => setShowKeyModal(true)}
                                className="text-paper-500 hover:text-paper-800 transition-colors p-2 rounded-full hover:bg-paper-200"
                                title="API Settings"
                            >
                                <Icons.Key />
                            </button>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-4 mt-8">
                        
                        {/* Search Section */}
                        <div className="text-center mb-12">
                            <h1 className="text-3xl md:text-4xl font-serif font-bold text-paper-900 mb-6 leading-tight">
                                探索词语背后的<br/><span className="text-paper-600 italic">故事与灵魂</span>
                            </h1>
                            <div className="relative max-w-xl mx-auto">
                                <input 
                                    type="text" 
                                    value={query}
                                    onChange={(e) => setQuery(e.target.value)}
                                    onKeyDown={(e) => e.key === 'Enter' && performSearch()}
                                    placeholder="输入一个英语单词..."
                                    className="w-full pl-6 pr-14 py-4 rounded-2xl border-2 border-paper-200 bg-white shadow-lg text-lg focus:outline-none focus:border-paper-400 focus:ring-4 focus:ring-paper-100 transition-all font-serif placeholder:font-sans placeholder:text-paper-300"
                                />
                                <button 
                                    onClick={performSearch}
                                    className="absolute right-3 top-3 p-2 bg-paper-800 text-white rounded-xl hover:bg-paper-700 transition-all shadow-md active:scale-95"
                                >
                                    <Icons.Search />
                                </button>
                            </div>
                        </div>

                        {/* Loading State */}
                        {loading && (
                            <div className="flex flex-col items-center justify-center py-20">
                                <span className="quill-loader mb-4"></span>
                                <p className="text-paper-500 font-serif italic">Consulting the ancient texts...</p>
                            </div>
                        )}

                        {/* Error State */}
                        {error && (
                            <div className="bg-red-50 border border-red-200 text-red-800 p-6 rounded-xl mb-8 text-center shadow-sm">
                                <p className="font-bold mb-2">Ah, a smudge on the page (Error)</p>
                                <p className="text-sm opacity-80">{error}</p>
                            </div>
                        )}

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                            
                            {/* Main Content Column */}
                            <div className="lg:col-span-2">
                                {data && (
                                    <>
                                        {/* Header Card */}
                                        <div className="bg-white rounded-2xl shadow-md border border-paper-200 p-8 mb-8 text-center relative overflow-hidden animate-fade-in">
                                            <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-paper-300 via-paper-500 to-paper-300"></div>
                                            <div className="flex justify-center items-end gap-4 mb-2">
                                                <h2 className="text-5xl font-serif font-bold text-paper-900">{data.word}</h2>
                                                <span className="text-lg text-paper-500 font-serif italic mb-2">/{data.ipa}/</span>
                                            </div>
                                            <div className="flex justify-center items-center gap-3 mb-6">
                                                <span className="italic text-paper-600 font-medium">{data.part_of_speech}</span>
                                                <button 
                                                    onClick={() => handleSpeak(data.word)}
                                                    className="p-2 rounded-full bg-paper-100 text-paper-700 hover:bg-paper-200 transition-colors"
                                                    title="Listen"
                                                >
                                                    <Icons.Volume />
                                                </button>
                                            </div>
                                            <p className="text-xl text-ink leading-relaxed mb-2">{data.definition_en}</p>
                                            <p className="text-lg text-paper-600 font-serif">{data.definition_zh}</p>

                                            <button 
                                                onClick={handleAddVocab}
                                                className={`mt-6 flex items-center gap-2 mx-auto px-6 py-2 rounded-full transition-all ${
                                                    vocabList.some(v => v.word === data.word)
                                                    ? 'bg-green-100 text-green-700 border border-green-200 cursor-default'
                                                    : 'bg-paper-800 text-white hover:bg-paper-700 shadow-lg hover:shadow-xl'
                                                }`}
                                            >
                                                {vocabList.some(v => v.word === data.word) ? (
                                                    <><span>已收藏</span></>
                                                ) : (
                                                    <><Icons.Plus /> <span>加入生词表</span></>
                                                )}
                                            </button>
                                        </div>

                                        {/* Etymology Card */}
                                        <Card title="词源故事" icon={Icons.BookOpen} delay="0.1s">
                                            <div className="prose prose-stone max-w-none">
                                                <p className="text-lg leading-8 text-ink font-serif first-letter:text-5xl first-letter:font-bold first-letter:text-paper-800 first-letter:mr-2 first-letter:float-left">
                                                    {data.etymology_story}
                                                </p>
                                            </div>
                                        </Card>

                                        {/* Morphology Card */}
                                        <Card title="构词解析" icon={Icons.Puzzle} delay="0.2s">
                                            <div className="bg-paper-50 rounded-lg p-4 border border-paper-100 mb-4">
                                                <div className="flex flex-col sm:flex-row sm:items-center gap-4">
                                                    <div className="flex-1">
                                                        <span className="text-xs uppercase tracking-wider text-paper-500">词根/Root</span>
                                                        <p className="font-bold text-xl text-paper-900">{data.morphology.root}</p>
                                                    </div>
                                                    <div className="flex-1 border-l border-paper-200 pl-0 sm:pl-4">
                                                        <span className="text-xs uppercase tracking-wider text-paper-500">含义/Meaning</span>
                                                        <p className="font-serif italic text-lg text-paper-800">{data.morphology.root_meaning}</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <span className="text-sm text-paper-500 mb-2 block">同根衍生词：</span>
                                                <div className="flex flex-wrap">
                                                    {data.morphology.related_words.map(w => (
                                                        <button key={w} onClick={() => {setQuery(w); window.scrollTo(0,0); performSearch();}} className="mr-2 mb-2 px-3 py-1 bg-white border border-paper-200 rounded hover:border-paper-400 text-paper-700 text-sm transition-colors">
                                                            {w}
                                                        </button>
                                                    ))}
                                                </div>
                                            </div>
                                        </Card>

                                        {/* Synonyms/Antonyms */}
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6 animate-slide-up" style={{animationDelay: '0.3s'}}>
                                            <div className="bg-white p-6 rounded-xl shadow-sm border border-paper-200">
                                                <h4 className="font-bold text-paper-400 text-sm uppercase tracking-widest mb-3">Synonyms / 近义词</h4>
                                                <div className="flex flex-wrap">
                                                    {data.synonyms.map(w => <Badge key={w} color="stone">{w}</Badge>)}
                                                </div>
                                            </div>
                                            <div className="bg-white p-6 rounded-xl shadow-sm border border-paper-200">
                                                <h4 className="font-bold text-paper-400 text-sm uppercase tracking-widest mb-3">Antonyms / 反义词</h4>
                                                <div className="flex flex-wrap">
                                                    {data.antonyms.map(w => <Badge key={w} color="rose">{w}</Badge>)}
                                                </div>
                                            </div>
                                        </div>

                                        {/* Literature Examples */}
                                        <Card title="经典例句" icon={Icons.Quill} delay="0.4s">
                                            <ul className="space-y-6">
                                                {data.literature_examples.map((ex, idx) => (
                                                    <li key={idx} className="relative pl-6 border-l-2 border-paper-300">
                                                        <p className="font-serif text-lg text-ink mb-1">"{ex.en}"</p>
                                                        <p className="text-paper-600 mb-2 text-sm">{ex.zh}</p>
                                                        <p className="text-xs font-bold text-paper-400 uppercase tracking-wide">— {ex.source}</p>
                                                    </li>
                                                ))}
                                            </ul>
                                        </Card>
                                    </>
                                )}

                                {!data && !loading && !error && (
                                    <div className="text-center py-20 opacity-60">
                                        <div className="w-24 h-24 bg-paper-200 rounded-full mx-auto mb-6 flex items-center justify-center text-paper-400">
                                            <Icons.BookOpen className="w-10 h-10" />
                                        </div>
                                        <p className="font-serif text-xl text-paper-600">Waiting to illuminate a word...</p>
                                    </div>
                                )}
                            </div>

                            {/* Sidebar / Vocab List */}
                            <div className="lg:col-span-1">
                                <div className="bg-white rounded-xl shadow-sm border border-paper-200 p-6 sticky top-24">
                                    <h3 className="font-serif text-xl text-paper-900 mb-4 pb-2 border-b border-paper-100 flex justify-between items-center">
                                        <span>生词表</span>
                                        <span className="text-xs bg-paper-100 text-paper-600 px-2 py-1 rounded-full font-sans">{vocabList.length}</span>
                                    </h3>
                                    
                                    {vocabList.length === 0 ? (
                                        <p className="text-paper-400 text-sm italic text-center py-8">Empty parchment...</p>
                                    ) : (
                                        <ul className="space-y-3 max-h-[60vh] overflow-y-auto pr-2 hide-scrollbar">
                                            {vocabList.map((item, idx) => (
                                                <li key={idx} className="group bg-paper-50 hover:bg-paper-100 rounded-lg p-3 transition-colors border border-transparent hover:border-paper-200">
                                                    <div className="flex justify-between items-start">
                                                        <div 
                                                            className="cursor-pointer"
                                                            onClick={() => {
                                                                setQuery(item.word);
                                                                window.scrollTo(0,0);
                                                            }}
                                                        >
                                                            <p className="font-bold text-paper-900">{item.word}</p>
                                                            <p className="text-xs text-paper-600 line-clamp-1">{item.def}</p>
                                                        </div>
                                                        <button 
                                                            onClick={() => removeVocab(item.word)}
                                                            className="text-paper-300 hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100"
                                                        >
                                                            <Icons.Trash />
                                                        </button>
                                                    </div>
                                                </li>
                                            ))}
                                        </ul>
                                    )}
                                </div>
                            </div>

                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="text-center text-paper-400 text-sm py-8 mt-8">
                        <p className="font-serif">Powered by Gemini 2.5 Flash</p>
                    </footer>

                    {/* API Key Modal */}
                    {showKeyModal && (
                        <div className="fixed inset-0 bg-paper-900/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-slide-up">
                                <h2 className="text-2xl font-serif font-bold text-paper-900 mb-4">Library Card Required</h2>
                                <p className="text-paper-600 mb-6 leading-relaxed">
                                    To access the infinite library of EtymoLogos, please present your Google Gemini API Key.
                                    <br/>
                                    <span className="text-xs text-paper-400 block mt-2">The key is stored locally in your browser.</span>
                                </p>
                                <input 
                                    type="password" 
                                    placeholder="Paste API Key here..."
                                    className="w-full p-3 border border-paper-200 rounded-lg mb-4 focus:ring-2 focus:ring-paper-400 focus:outline-none"
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                />
                                <div className="flex justify-end gap-3">
                                    {(() => {
                                        try {
                                            return localStorage.getItem("gemini_api_key");
                                        } catch { return false; }
                                    })() && (
                                        <button 
                                            onClick={() => setShowKeyModal(false)}
                                            className="px-4 py-2 text-paper-500 hover:text-paper-800"
                                        >
                                            Close
                                        </button>
                                    )}
                                    <button 
                                        onClick={() => saveApiKey(apiKey)}
                                        disabled={!apiKey}
                                        className="px-6 py-2 bg-paper-800 text-white rounded-lg hover:bg-paper-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors"
                                    >
                                        Enter Library
                                    </button>
                                </div>
                                <div className="mt-6 text-center">
                                     <a href="https://aistudio.google.com/app/apikey" target="_blank" className="text-xs text-paper-500 hover:underline hover:text-paper-800">Get a free API Key</a>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>